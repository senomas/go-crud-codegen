{{- if not (eq .Table "") -}}
-- FILE-2db0326db4c0e6f669fd9a1253dd2e3: migrations/{{printf "%04d" .Seq}}-{{snakeCase .ID}}.sql
-- Code generated by apigen. DO NOT EDIT.
-- GENERATED: {{now}}
-- DB: {{.DB}}

{{ template "CreateTable" . }}

-- FILE-2db0326db4c0e6f669fd9a1253dd2e3: migrations/{{printf "%04d" .Seq}}-{{snakeCase .ID}}.drop.sql
-- Code generated by apigen. DO NOT EDIT.
-- GENERATED: {{now}}
-- DB: {{.DB}}

{{ template "DropTable" . -}}

{{ range .Fields -}}
  {{- if eq .Type "many-to-many" }}
-- FILE-2db0326db4c0e6f669fd9a1253dd2e3: migrations/{{printf "%04d" .Seq}}-{{snakeCase .Model.ID}}-{{snakeCase .ID}}.sql
-- Code generated by apigen. DO NOT EDIT.
-- GENERATED: {{now}}
-- DB: {{.Model.DB}}

{{ template "CreateTable.Map" . }}

-- FILE-2db0326db4c0e6f669fd9a1253dd2e3: migrations/{{printf "%04d" .Seq}}-{{snakeCase .Model.ID}}-{{snakeCase .ID}}.drop.sql
-- Code generated by apigen. DO NOT EDIT.
-- GENERATED: {{now}}
-- DB: {{.Model.DB}}

{{ template "DropTable.Map" . }}

  {{- end}}
{{- end}}{{end}}

{{ define "SqlTypeRef" -}}
  {{- if eq .Type "autoincrement" }}
    {{- "INTEGER" -}}
  {{- else if or (eq .Type "text" "password" "secret") }}
    {{- if eq .Length 0 }}
      {{- "TEXT"}}
    {{- else }}
      {{- printf "VARCHAR(%d)" .Length }}
    {{- end}}
  {{- else if or (eq .Type "int" "version") }}
    {{- "INTEGER"}}
  {{- else if eq .Type "timestamp" }}
    {{- "TIMESTAMP"}}
  {{- else if eq .Type "json" }}
    {{- "JSONB"}}
  {{- else }}
    {{- .Type}}
  {{- end}}
{{- end -}}

{{ define "SqlType" -}}
  {{- if eq .Type "autoincrement" }}
    {{- "BIGSERIAL" -}}
  {{- else }}
    {{- template "SqlTypeRef" .}}{{ if not .Null }} NOT NULL{{end}}
  {{- end}}
{{- end -}}

